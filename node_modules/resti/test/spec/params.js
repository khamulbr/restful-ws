describe('resti', function() {
	var swapi;
	var swapiUrl = 'http://swapi.co/api';

	beforeEach(function() {
		swapi = new resti(swapiUrl);
		jasmine.Ajax.install();
	});

	afterEach(function() {
		resti.reset();
		jasmine.Ajax.uninstall();
	});

	describe('params', function() {
		
		describe('with one object param', function() {
			it('sets the param and value in the params object', function() {
				swapi.params({
					'first': 'first'
				});
				expect(swapi.parameters).toEqual({
					'first': 'first'
				});
			});
		});

		describe('with two string params', function() {
			it ('sets the param and value in the params object', function() {
				swapi.params('first', 'first');
				expect(swapi.parameters).toEqual({
					'first': 'first'
				});
			});
		});

		describe('with one object param with multiple params', function() {
			it('sets correct parameters', function() {
				swapi.params({'first': 'second', 'third': 'fourth'});
				expect(swapi.parameters).toEqual({'first': 'second', 'third': 'fourth'});
			});

		});

		describe('sends to correct url', function() {
			
			it('set with two strings', function() {
				swapi.params('page', 2).get();
				expect(jasmine.Ajax.requests.mostRecent().url).toEqual('http://swapi.co/api?page=2');
			});

			it('set with object', function() {
				swapi.params({'page': 2}).get();
				expect(jasmine.Ajax.requests.mostRecent().url).toEqual('http://swapi.co/api?page=2');
			});

			it('set multiple times', function() {
				swapi.params('page', 2).params('name', 'Fergus').get();
				expect(jasmine.Ajax.requests.mostRecent().url).toEqual('http://swapi.co/api?page=2&name=Fergus');
			});

		});

	});

	describe('params', function() {
		it('set with two strings', function() {
			swapi.params('page', 2).get();
			expect(jasmine.Ajax.requests.mostRecent().url).toEqual('http://swapi.co/api?page=2');
		});
		it('set with object', function() {
			swapi.params({'page': 2}).get();
			expect(jasmine.Ajax.requests.mostRecent().url).toEqual('http://swapi.co/api?page=2');
		});
		it('set multiple times', function() {
			swapi.params('page', 2).params('name', 'Fergus').get();
			expect(jasmine.Ajax.requests.mostRecent().url).toEqual('http://swapi.co/api?page=2&name=Fergus');
		});
	});

});